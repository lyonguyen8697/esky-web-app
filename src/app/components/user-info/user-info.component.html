<div class="container">
    <div class="card card-shadow">
        <div class="card-body p-3 p-sm-5">
            <div class="text-center mb-4">
                <div class="user-avatar mb-2">
                    <img class="rounded-circle" src="https://yt3.ggpht.com/-p9eRJnFCuSA/AAAAAAAAAAI/AAAAAAAAAAA/vv1wS4dO3GY/s88-c-k-no-mo-rj-c0xffffff/photo.jpg"
                        alt="Avatar">
                </div>
                <div class="user-name">
                    {{user.name}}
                </div>
                <div class="user-role text-muted">
                    {{user.role | titlecase}}
                </div>
            </div>
            <div class="user-panel mr-md-5">
                <h3 class="mb-3">Account</h3>
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="email">Email</label>
                    <div class="col-sm-8">
                        <input type="email" name="email" id="email" class="form-control-plaintext" readonly 
                        [(ngModel)]="user.email">
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="username">Username</label>
                    <div class="col-sm-8">
                        <input type="text" name="username" id="username" class="form-control" placeholder="Tên người dùng"
                        [(ngModel)]="info.username"
                        (ngModelChange)="onUsernameChange()"
                        (blur)="hideAllTooltip()"
                        [class.form-control]="editable"
                        [class.form-control-plaintext]="!editable"
                        [class.is-invalid]="info.usernameError === true && editing"
                        [readonly]="!editing">
                        <div class="tooltip-container tooltip-username" [class.d-none]="!info.usernameError || !editing">
                            <app-tooltip [title]="info.usernameErrorMess" [isError]="info.usernameError"></app-tooltip>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <label class="col-sm-4 col-form-label" for="name">Full name</label>
                    <div class="col-sm-8">
                        <input type="text" name="name" id="name" class="form-control" placeholder="Họ tên"
                        [(ngModel)]="info.name"
                        (ngModelChange)="onNameChange()"
                        (blur)="hideAllTooltip()"
                        [class.form-control]="editable"
                        [class.form-control-plaintext]="!editable"
                        [class.is-invalid]="info.nameError === true && editing"
                        [readonly]="!editing">
                        <div class="tooltip-container tooltip-name" [class.d-none]="!info.nameError || !editing">
                            <app-tooltip [title]="info.nameErrorMess" [isError]="info.nameError"></app-tooltip>
                        </div>
                    </div>
                </div>
                <div *ngIf="editable" class="form-group row">
                    <label class="col-sm-4 col-form-label" for="password">Password</label>
                    <div class="col-sm-8">
                        <input type="password" name="password" id="password" class="form-control" placeholder="Mật khẩu mới"
                        [(ngModel)]="info.password"
                        (ngModelChange)="onPasswordChange()"
                        (focus)="onFocusPassword()"
                        (blur)="hideAllTooltip()"
                        [class.form-control]="editable"
                        [class.form-control-plaintext]="!editable"
                        [class.is-invalid]="info.passwordError === true && editing"
                        [readonly]="!editing">
                        <div class="tooltip-container tooltip-password" [class.d-none]="!info.passwordError || !editing">
                            <app-tooltip [title]="info.passwordErrorMess" [isError]="info.passwordError"></app-tooltip>
                        </div>
                    </div>
                </div>
                <div *ngIf="!editing; else editCase" class="d-flex justify-content-end">
                    <button type="button" class="btn btn-warning" (click)="edit()">Chỉnh sửa</button>
                </div>
                <ng-template #editCase>
                    <div class="d-flex justify-content-end">
                        <button type="button" class="btn btn-secondary ml-2" (click)="cancelEdit()">Hủy bỏ</button>
                        <button type="button" class="btn btn-primary ml-2"
                        (click)="save()"
                        [disabled]="!infoChanged">Lưu</button>
                        <div class="modal fade" id="confirmPasswordModal" tabindex="-1" role="dialog" 
                        aria-labelledby="confirmPasswordModalLabel" 
                        aria-hidden="true">
                            <div class="modal-dialog" role="document">
                              <div class="modal-content">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="confirmPasswordModalLabel">
                                      Xác nhận mật khẩu của bạn để tiếp tục
                                    </h5>
                                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                  </button>
                                </div>
                                <div class="modal-body">
                                    <div class="form-group">
                                        <label for="confirmPassword">Mật khẩu</label>
                                        <input type="password" name="password" class="form-control" id="confirmPassword"
                                        [(ngModel)]="info.credentials">
                                    </div>
                                    <div class="d-flex justify-content-end">
                                        <div class="w-100 align-self-center text-danger">
                                            Lỗi: {{serverError}}
                                        </div>
                                        <button type="button" class="btn btn-secondary ml-2" data-dismiss="modal">Trở lại</button>
                                        <button type="button" class="btn btn-primary ml-2" (click)="submit()"
                                        [disabled]="submitted">
                                        Xác nhận
                                        </button>
                                    </div>
                                </div>
                              </div>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>
</div>